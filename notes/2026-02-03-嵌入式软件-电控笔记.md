# 嵌入式软件—电控笔记




第零节 开发环境搭建

第一节 GPIO

第二节 EXTI

第三节 USART

第四节 TIM

第五节 ADC

第六节 IIC

第七节 FLASH

第八节 CAN

第九节 FreeRTOS




---
## 必须有（不具备就很难跑起来）

1. **开发环境 + 调试**（下载、断点、串口日志）
2. **定时器 TIM**（控制环节拍：比如 500Hz–1kHz）
3. **电机驱动链路**

   * 电机驱动板/电调（FOC/伺服/电调）
   * **编码器读数**（磁编码器/增量编码器/电机自带）用于低速大扭矩闭环
4. **CAN 通信**（C 板 ↔ 电机驱动器：发指令/收反馈）
5. **IMU 读取（推荐 SPI）**（陀螺仪+加速度计）
6. **姿态估计/滤波**（互补/Mahony/Madgwick/EKF 任一）
7. **基本控制器**

   * 平衡控制（PID/LQR）
   * 速度/位置外环（至少速度）
8. **安全保护**

   * 急停（GPIO+EXTI）
   * 低压/过温/通信丢失降级
   * 看门狗

## 强烈建议有（能稳、能调、能迭代）

9. **USART 上位机调参/日志**（参数在线调、记录数据）
10. **DMA**（IMU/串口/CAN 高速不占 CPU，避免控制环卡顿）
11. **FLASH 参数存储**（IMU 零偏、编码器 offset、控制增益、限幅）

## 做“跳跃”基本必加（否则容易摔/容易烧）

12. **力矩控制（电流控制）能力**（Iq/限流/峰值限制）
13. **状态机**（站立/行走/起跳/腾空/落地/故障）
14. **落地缓冲与触地检测**（触地开关/电流突变/IMU 冲击判据，任选一种或组合）

## 可选

15. **FreeRTOS**（系统复杂了再上；不是刚需）
16. **额外传感器**（轮速编码器、足端触地、测距、相机等）
17. **Bootloader/多固件切换**（升级/比赛模式）

